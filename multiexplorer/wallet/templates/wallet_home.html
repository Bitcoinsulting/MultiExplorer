{% extends "base.html" %}
{% load staticfiles %}

{% block content %}
<link rel="stylesheet" href="{% static 'jquery-ui.min.css' %}">
<script src="{% static 'jquery-ui.min.js' %}"></script>
<script src="{% static 'aes.js' %}"></script>
<script src="{% static 'bitcore-lib.min.js' %}"></script>
<script src="{% static 'bitcore-mnemonic.min.js' %}"></script>
<script src="{% static 'underscore-min.js' %}"></script>
<script>
    var bitcore = require('bitcore-lib');
    var Mnemonic = require('bitcore-mnemonic');
    var crypto_data = JSON.parse('{{ crypto_data_json|safe }}');
    var hd_master_seed = undefined;
</script>
<script src="{% static 'wallet.js' %}"></script>
<style>
    .center_box {
        width: 250px;
        margin: 20px auto 0 auto;
        background: #dfdfdf;
        padding: 10px;
        border: 1px solid brown;
        border-radius: 7px;
    }

    #wallets {
        display: flex;
        flex-wrap: wrap;
        flex-direction: row;
        justify-content: space-around;
    }

    .deposit_address {
        font-size: small;
    }

    .crypto_box {
        border: 1px solid green;
        background: #efd4ef;
        padding: 10px;
        margin: 10px;
        text-align: center;
    }

    .qr {
        width: 100px;
        height: 100px;
    }
    button {
        padding: 7px;
        margin: 3px;
        font-weight: bold;
    }
    .deposit_area {
        background: white;
        padding: 5px 3px 5px 3px;
        margin: 5px;
        width: 17em;
    }

    .send_btn {
        background: #84FF8A;
        padding: 5px;
        margin: 5px;
    }

    #loading_screen {
        display: none;
        border: 1px solid green;
        width: 250px;
        margin: 0 auto 0 auto;
        padding: 10px;
        text-align: center;
    }
</style>
{% include "login.html" %}

{% if not user.is_authenticated %}
    {% include "register.html" %}
{% endif %}

<div id="fiat_exchange_rates" style="display: none">
    <span class="fiat_symbol">USD</span>
    {% for crypto, data in exchange_rates.items %}
        <span class="rate {{ crypto }}">{{ data.rate }}</span>
        <span class="provider {{ crypto }}">{{ data.provider }}</span>
    {% endfor %}
</div>

<div style="width: 100%;">
    <div id="loading_screen">
        Deriving Wallet Addresses and Generating QR codes...<br><br>
        <img src="{% static 'spin.gif' %}">
    </div>
</div>

<div id="wallets" style="display: none">
    {% for data in crypto_data %}
    <div class="crypto_box" data-currency="{{ data.code }}">
        <h3>{{ data.name }} ({{ data.code|upper }})</h3>
        Balance: <span class="crypto_balance">0.0</span> {{ data.code|upper }}<br>
        Fiat: <span class="fiat_balance">0.0</span> <span class="fiat_unit">USD</span>
        <span class="balance_fiat"></span>
        <table style="width: 100%">
            <tr>
                <td style="width: 50%">
                    <img src="{% static data.logo %}" style="width: 100px; height: 100px">
                </td>
                <td style="width: 50%">
                    <div class="qr"></div>
                </td>
            </tr>
            <tr>
                <td><button class="deposit_shift_up" style="width: 75%">&larr;</button></td>
                <td><button class="deposit_shift_down" style="width: 75%">&rarr;</button></td>
            </tr>
        </table>
        <div class="deposit_area">
            <span class="deposit_address"></span>
        </div>
        <button class="send">Send</button>
        <button class="exchange">Exchange</button>
        <button class="history">History</button>
    </div>
    {% endfor %}
</div>

<div style="display: none">
    <div id="send_modal">
        <lable>Address</label><br>
        <input type="text" id="sending_recipient_address">

        <br><br>

        <label>Crypto Amount</label><br>
        <input type="text" id="sending_crypto_amount"> <span id="sending_crypto_unit"></span>

        <br><br>

        <label>Fiat Amount</label><br>
        <input type="text" id="sending_fiat_amount"> <span class="fiat_unit">USD</span>

        <br><br>

        <input id="half_fee" type="radio" name="fee" value="">
        <label for="half">Half Optimal Fee (<span id="full_fee_rate"><img src="{% static 'spin.gif' %}"></span>)</label><br>

        <input id="full_fee" type="radio" name="fee" value="" checked>
        <label for="full">Optimal Fee (<span id="full_fee_rate"><img src="{% static 'spin.gif' %}"></span>)</label><br>

        <input id="double_fee" type="radio" name="fee" value="">
        <label for="double">Double Optimal Fee (<span id="double_fee_rate"><img src="{% static 'spin.gif' %}"></span>)</label><br>
    </div>

    <div id="history_modal">
        history
    </div>

    <div id="exchange_modal">
        exchange
    </div>
</div>
{% endblock %}
